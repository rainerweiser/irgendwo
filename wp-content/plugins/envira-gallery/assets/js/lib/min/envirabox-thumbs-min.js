!function(t,$){"use strict";var i=function(t){this.instance=t,this.init()};$.extend(i.prototype,{$button:null,$grid:null,$list:null,isVisible:!1,init:function(){var t=this,i=t.instance.group[0],s=t.instance.group[1];t.$button=t.instance.$refs.toolbar.find("[data-envirabox-thumbs]"),t.instance.group.length>1&&t.instance.group[t.instance.currIndex].opts.thumbs&&("image"==i.type||i.opts.thumb||i.opts.$thumb)&&("image"==s.type||s.opts.thumb||s.opts.$thumb)?(t.$button.on("click touchstart",function(){t.toggle()}),t.isActive=!0):(t.$button.hide(),t.isActive=!1)},create:function(){var t=this.instance,i,s;this.$grid=$('<div class="envirabox-thumbs envirabox-thumbs-'+t.opts.thumbs.position+'"></div>').appendTo(t.$refs.container),i="<ul>",$.each(t.group,function(t,e){if(s=e.opts.thumb||(e.opts.$thumb?e.opts.$thumb.attr("src"):null),s||"image"!==e.type||(s=e.src),s&&s.length){var n=void 0!==e.contentProvider?e.contentProvider:null;i+='<li data-index="'+t+'"  tabindex="0" class="envirabox-thumbs-loading envirabox-thumb-content-provider-'+n+" envirabox-thumb-type-"+e.type+'"><img class="envirabox-thumb-image-'+e.type+" envirabox-thumb-content-provider-"+n+'" data-src="'+s+'" />',"1"!=e.enviraThumbnailPlayIcon||"video"!=e.type&&"genericDiv"!=e.type&&"youtube"!=n&&"vimeo"!=n&&"instagram"!=n&&"twitch"!=n&&"dailymotion"!=n&&"metacafe"!=n&&"wistia"!=n&&"videopress"!=n||(i+='<div class="envira-video-play-icon">Play</div>'),i+="</li>"}}),i+="</ul>",this.$list=$(i).appendTo(this.$grid).on("click touchstart","li",function(){t.jumpTo($(this).data("index"))}),this.$list.find("img").hide().one("load",function(){var t=$(this).parent().removeClass("envirabox-thumbs-loading"),i=$(this).outerWidth(),s=$(this).outerHeight(),e,n,o,a;e=this.naturalWidth||this.width,n=this.naturalHeight||this.height,o=e/i,a=n/s,o>=1&&a>=1&&(o>a?(e/=a,n=s):(e=i,n/=o)),$(this).css({width:Math.floor(e),height:Math.floor(n),"margin-top":Math.min(0,Math.floor(.3*s-.3*n)),"margin-left":Math.min(0,Math.floor(.5*i-.5*e))}).show()}).each(function(){this.src=$(this).data("src")})},focus:function(){this.instance.current&&this.$list.children().removeClass("envirabox-thumbs-active").filter('[data-index="'+this.instance.current.index+'"]').addClass("envirabox-thumbs-active").focus()},close:function(){this.$grid.hide()},update:function(){this.instance.$refs.container.toggleClass("envirabox-show-thumbs",this.isVisible),this.isVisible?(this.$grid||this.create(),this.instance.trigger("onThumbsShow"),this.focus()):this.$grid&&this.instance.trigger("onThumbsHide"),this.instance.update()},hide:function(){this.isVisible=!1,this.update()},show:function(){this.isVisible=!0,this.update()},toggle:function(){this.isVisible=!this.isVisible,this.update()}}),$(t).on({"onInit.eb":function(t,s){s&&!s.Thumbs&&(s.Thumbs=new i(s))},"beforeShow.eb":function(t,i,s,e){var n=i&&i.Thumbs;if(n&&n.isActive){if(s.modal)return n.$button.hide(),void n.hide();e&&s.opts.thumbs.autoStart===!0&&n.show(),n.isVisible&&n.focus()}},"afterKeydown.eb":function(t,i,s,e,n){var o=i&&i.Thumbs;o&&o.isActive&&71===n&&(e.preventDefault(),o.toggle())},"beforeClose.eb":function(t,i){var s=i&&i.Thumbs;s&&s.isVisible&&i.opts.thumbs.hideOnClose!==!1&&s.close()}})}(document,window.jQuery);