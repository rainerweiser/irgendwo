function envira_pagination_get_query_arg(e,a){e=e.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),n=i.exec(a);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}var envira_pagination_requesting=!1;jQuery(document).ready(function($){$(document).on("click","div.envira-pagination-ajax-load a",function(e){if(e.preventDefault(),!envira_pagination_requesting){envira_pagination_requesting=!0;var a=$(this).parent(),i=$(a).parent().attr("id").split("envira-gallery-wrap-")[1],n=$(a).parent().find("div#envira-gallery-"+i),t=$(a).data("type"),r=envira_pagination_get_query_arg("page",$(this).attr("href")),o=Cookies.get("envira_proofing_email"),l=a.data("envira-post-id");(void 0==l||""==l)&&(l=i);var p=[];n.find(".envira-gallery-position-overlay:first > div").each(function(){console.log(this),p.push($(this).attr("class"))}),$.ajax({type:"POST",url:envira_pagination.ajax,data:{action:"envira_pagination_get_page",nonce:envira_pagination.nonce,envira_post_id:l,post_id:i,type:t,page:r,envira_proofing_email:o}}).done(function(e){if(""!=e){$(document).trigger("enviraPaginate");var o=$(e),l=$(o).find("div#envira-gallery-"+i),s=$(o).find(".envira-pagination-ajax-load").first();$(".envira-pagination-ajax-load",$(a).parent()).replaceWith($(s)),$(n).replaceWith($(l));var d=$("#envira-gallery-"+i);p.forEach(function(e){"envira-printing-button"!=e&&$("#envira-gallery-"+i+" .envira-gallery-position-overlay ."+e).show().css("display","inline-block")}),$(document).trigger({type:"envira_pagination_ajax_load_completed",id:i,id_type:t,page:r,response:e}),envira_pagination_requesting=!1,$(document).trigger("envira_load")}}).fail(function(e){$(document).trigger({type:"envira_pagination_ajax_load_error",id:i,id_type:t,page:r,response:e})})}}),$("div.envira-pagination-ajax-load-more").each(function(){var e=$(this).parent(),a=$(this).data("type"),i=$(this).data("blog-id"),n=$(this).parent().attr("id").split("envira-gallery-wrap-")[1],t=Number($(this).attr("data-page")),r=Number($(this).attr("data-max-pages")),o=!1;$(this).on("click","a.envira-pagination-load-more",function(l){if(l.preventDefault(),!o){o=!0;var p=$(this);p.addClass("envira-loading"),envira_pagination_exclusions=new Array,e.find("img.envira-gallery-image").each(function(){envira_pagination_exclusions.push($(this).data("envira-item-id"))});var s=[];e.find(".envira-gallery-position-overlay:first > div").each(function(){console.log(this),s.push($(this).attr("class"))}),$.ajax({type:"POST",url:envira_pagination.ajax,data:{action:"envira_pagination_get_items",nonce:envira_pagination.nonce,post_id:n,type:a,blog_id:i,page:Number(t+1),trigger:"button",exclusions:envira_pagination_exclusions}}).done(function(i){if(""==i||"0"==i)return void $(e).find(".envira-pagination-load-more").hide();p.removeClass("envira-loading");var l=$("#envira-gallery-"+n);l.hasClass("enviratope")?l.enviratope("insert",$(i)):l.append(i),$("#envira-gallery-"+n+" .envira-gallery-item img").fadeTo("slow",1),s.forEach(function(e){"envira-printing-button"!=e&&$("#envira-gallery-"+n+" .envira-gallery-position-overlay ."+e).show().css("display","inline-block")}),"undefined"!=typeof r&&r===t+1?($(e).find(".envira-pagination-load-more").hide(),$(document).trigger({type:"envira_pagination_lazy_load_completed_inal",id:n,id_type:a,page:t,response:i})):(t=Number(t+1),$("div.envira-pagination-ajax-load",$(e)).attr("data-page",t),$(document).trigger({type:"envira_pagination_lazy_load_completed",id:n,id_type:a,page:t,response:i})),o=!1,$(document).trigger("envira_load")}).fail(function(e){$(document).trigger({type:"envira_pagination_lazy_load_error",id:n,id_type:a,page:t,response:e})})}})}),$("div.envira-pagination-lazy-load").each(function(){function e(){if(!l){l=!0,envira_pagination_exclusions=new Array,a.find("img.envira-gallery-image").each(function(){envira_pagination_exclusions.push($(this).data("envira-item-id"))});var e=[];t.find(".envira-gallery-position-overlay:first > div").each(function(){console.log(this),e.push($(this).attr("class"))}),$.ajax({type:"POST",async:!1,url:envira_pagination.ajax,data:{action:"envira_pagination_get_items",nonce:envira_pagination.nonce,envira_post_id:p,post_id:n,type:i,page:Number(o+1),trigger:"scroll",exclusions:envira_pagination_exclusions}}).done(function(t){function r(){l=!1}if(""!=t){var p=$("#envira-gallery-"+n);p.hasClass("envira-gallery-justified-public")?(p.append(t),p.enviraJustifiedGallery("norewind"),setTimeout(r,3e3)):p.hasClass("enviratope")?(p.enviratope("insert",$(t)),g[n]=p.enviratope(c[n]).enviratope("layout"),g[n].enviraImagesLoaded().done(function(e){g[n].enviratope("layout"),l=!1}).progress(function(e,a){g[n].enviratope("layout")})):(p.append(t),l=!1),$("#envira-gallery-"+n+" .envira-gallery-item img").fadeTo("slow",1),e.forEach(function(e){"envira-printing-button"!=e&&$("#envira-gallery-"+n+" .envira-gallery-position-overlay ."+e).show().css("display","inline-block")}),o=Number(o+1),$("div.envira-pagination-ajax-load",$(a)).attr("data-page",o),$(document).trigger({type:"envira_pagination_lazy_load_completed",id:n,id_type:i,page:o,response:t}),$(document).trigger("envira_load")}}).fail(function(e){$(document).trigger({type:"envira_pagination_lazy_load_error",id:n,id_type:i,page:o,response:e})})}}var a=$(this).parent(),i=$(this).data("type"),n=$(this).parent().attr("id").split("envira-gallery-wrap-")[1],t=$(this).parent().find("div#envira-gallery-"+n),r=$(this).data("blog-id"),o=Number($(this).attr("data-page")),l=!1,p=a.data("envira-post-id"),s=[],d=[],g="album"===i?s:s,c="album"===i?d:d;(void 0==p||""==p)&&(p=n),$(this).hide();var v=0;$("html").on({touchmove:function(a){var i=a.originalEvent.touches[0].clientY;i>v&&e(),v=i},"mousewheel DOMMouseScroll":function(a){var i=a.originalEvent.wheelDelta||-a.originalEvent.detail;0>i&&e()}})})}),function(e){var a=!1;if("function"==typeof define&&define.amd&&(define(e),a=!0),"object"==typeof exports&&(module.exports=e(),a=!0),!a){var i=window.Cookies,n=window.Cookies=e();n.noConflict=function(){return window.Cookies=i,n}}}(function(){function e(){for(var e=0,a={};e<arguments.length;e++){var i=arguments[e];for(var n in i)a[n]=i[n]}return a}function a(i){function n(a,t,r){var o;if("undefined"!=typeof document){if(arguments.length>1){if(r=e({path:"/"},n.defaults,r),"number"==typeof r.expires){var l=new Date;l.setMilliseconds(l.getMilliseconds()+864*r.expires+5),r.expires=l}try{o=JSON.stringify(t),/^[\{\[]/.test(o)&&(t=o)}catch(p){}return t=i.write?i.write(t,a):encodeURIComponent(String(t)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),a=encodeURIComponent(String(a)),a=a.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),a=a.replace(/[\(\)]/g,escape),document.cookie=[a,"=",t,r.expires?"; expires="+r.expires.toUTCString():"",r.path?"; path="+r.path:"",r.domain?"; domain="+r.domain:"",r.secure?"; secure":""].join("")}a||(o={});for(var s=document.cookie?document.cookie.split("; "):[],d=/(%[0-9A-Z]{2})+/g,g=0;g<s.length;g++){var c=s[g].split("="),v=c.slice(1).join("=");'"'===v.charAt(0)&&(v=v.slice(1,-1));try{var u=c[0].replace(d,decodeURIComponent);if(v=i.read?i.read(v,u):i(v,u)||v.replace(d,decodeURIComponent),this.json)try{v=JSON.parse(v)}catch(p){}if(a===u){o=v;break}a||(o[u]=v)}catch(p){}}return o}}return n.set=n,n.get=function(e){return n.call(n,e)},n.getJSON=function(){return n.apply({json:!0},[].slice.call(arguments))},n.defaults={},n.remove=function(a,i){n(a,"",e(i,{expires:-1}))},n.withConverter=a,n}return a(function(){})});